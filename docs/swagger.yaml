basePath: /
definitions:
  database.ConnectionState:
    enum:
    - disconnected
    - connecting
    - connected
    - error
    type: string
    x-enum-varnames:
    - StateDisconnected
    - StateConnecting
    - StateConnected
    - StateError
  database.HealthStatus:
    properties:
      checked_at:
        type: string
      details:
        type: object
      healthy:
        type: boolean
      latency_ms:
        type: integer
      message:
        type: string
      state:
        $ref: '#/definitions/database.ConnectionState'
    type: object
  dto.APIResponse:
    properties:
      data:
        description: Dữ liệu trả về (nếu có)
      error:
        description: Lỗi (nếu có)
        example: ""
        type: string
      message:
        description: Thông báo
        example: Thao tác thành công
        type: string
      success:
        description: Request thành công hay thất bại
        example: true
        type: boolean
    type: object
  dto.ActiveSessionsResponse:
    properties:
      active_sessions:
        example: 3
        type: integer
    type: object
  dto.ApDungGiamGiaRequest:
    properties:
      phan_tram:
        description: Phần trăm giảm giá (0-100)
        example: 10
        type: integer
    type: object
  dto.AuthResponse:
    properties:
      access_token:
        example: eyJhbGciOiJIUzI1NiIs...
        type: string
      expires_in:
        description: seconds
        example: 900
        type: integer
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIs...
        type: string
      token_type:
        example: Bearer
        type: string
      user:
        $ref: '#/definitions/dto.UserResponse'
    type: object
  dto.CapNhatGiaRequest:
    properties:
      gia:
        description: Giá mới (VND)
        example: 55000
        type: integer
    type: object
  dto.ChangePasswordRequest:
    properties:
      new_password:
        example: newpass123
        maxLength: 100
        minLength: 6
        type: string
      old_password:
        example: oldpass123
        type: string
    required:
    - new_password
    - old_password
    type: object
  dto.CreateUserRequest:
    properties:
      email:
        example: john@example.com
        type: string
      password:
        example: password123
        maxLength: 100
        minLength: 6
        type: string
      role:
        enum:
        - admin
        - manager
        - staff
        - customer
        example: staff
        type: string
      username:
        example: john_doe
        maxLength: 50
        minLength: 3
        type: string
    required:
    - email
    - password
    - role
    - username
    type: object
  dto.LoginRequest:
    properties:
      password:
        example: password123
        type: string
      username:
        example: john_doe
        type: string
    required:
    - password
    - username
    type: object
  dto.LogoutAllResponse:
    properties:
      message:
        example: Đã đăng xuất khỏi tất cả thiết bị
        type: string
      revoked_sessions:
        example: 3
        type: integer
    type: object
  dto.MonAnResponse:
    properties:
      co_the_ban:
        description: Có thể bán không (business logic)
        example: true
        type: boolean
      con_hang:
        description: Còn bán không
        example: true
        type: boolean
      gia:
        description: Giá gốc
        example: 50000
        type: integer
      gia_sau_giam:
        description: Giá sau giảm giá
        example: 45000
        type: integer
      giam_gia:
        description: '% giảm giá'
        example: 10
        type: integer
      id:
        description: Mã món
        example: 1_mon
        type: string
      mo_ta:
        description: Mô tả
        example: Phở truyền thống
        type: string
      ngay_cap_nhat:
        description: Ngày cập nhật
        example: 24/01/2026 10:30
        type: string
      ngay_tao:
        description: Ngày tạo (format đẹp)
        example: 24/01/2026 10:00
        type: string
      ten:
        description: Tên món
        example: Phở bò tái
        type: string
    type: object
  dto.RefreshTokenRequest:
    properties:
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIs...
        type: string
    required:
    - refresh_token
    type: object
  dto.RefreshTokenResponse:
    properties:
      access_token:
        example: eyJhbGciOiJIUzI1NiIs...
        type: string
      expires_in:
        description: seconds
        example: 900
        type: integer
      token_type:
        example: Bearer
        type: string
    type: object
  dto.RegisterRequest:
    properties:
      email:
        example: john@example.com
        type: string
      password:
        example: password123
        maxLength: 100
        minLength: 6
        type: string
      username:
        example: john_doe
        maxLength: 50
        minLength: 3
        type: string
    required:
    - email
    - password
    - username
    type: object
  dto.ResendCooldownResponse:
    properties:
      message:
        example: Vui lòng đợi trước khi gửi lại
        type: string
      remaining_seconds:
        example: 45
        type: integer
    type: object
  dto.ResendVerificationResponse:
    properties:
      message:
        example: Email xác thực đã được gửi lại
        type: string
    type: object
  dto.ThemMonRequest:
    properties:
      gia:
        description: Giá món (VND)
        example: 50000
        type: integer
      mo_ta:
        description: Mô tả món ăn
        example: Phở truyền thống với thịt bò tái
        type: string
      ten:
        description: Tên món ăn
        example: Phở bò tái
        type: string
    type: object
  dto.UpdateUserRequest:
    properties:
      email:
        example: newemail@example.com
        type: string
      is_active:
        example: true
        type: boolean
    type: object
  dto.UserResponse:
    properties:
      created_at:
        example: 24/01/2026 10:00
        type: string
      email:
        example: john@example.com
        type: string
      id:
        example: uuid-123
        type: string
      is_active:
        example: true
        type: boolean
      is_email_verified:
        example: true
        type: boolean
      role:
        example: staff
        type: string
      updated_at:
        example: 24/01/2026 10:30
        type: string
      username:
        example: john_doe
        type: string
    type: object
  dto.VerifyEmailRequest:
    properties:
      token:
        example: abc123def456...
        type: string
    required:
    - token
    type: object
  dto.VerifyEmailResponse:
    properties:
      message:
        example: Email đã được xác thực thành công
        type: string
    type: object
  handler.HealthResponse:
    properties:
      services:
        additionalProperties:
          $ref: '#/definitions/database.HealthStatus'
        type: object
      status:
        type: string
      timestamp:
        type: string
      uptime:
        type: string
    type: object
  handler.LivenessResponse:
    properties:
      status:
        type: string
    type: object
  handler.ReadinessResponse:
    properties:
      ready:
        type: boolean
      status:
        type: string
    type: object
host: localhost:8080
info:
  contact:
    email: support@restaurant.local
    name: API Support
  description: API quản lý menu nhà hàng - Xây dựng theo Clean Architecture
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: http://swagger.io/terms/
  title: Restaurant Menu API
  version: 2.0.0
paths:
  /api/auth/login:
    post:
      consumes:
      - application/json
      description: Đăng nhập và nhận tokens
      parameters:
      - description: Thông tin đăng nhập
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.AuthResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Đăng nhập
      tags:
      - Auth
  /api/auth/logout:
    post:
      consumes:
      - application/json
      description: Đăng xuất và revoke access token hiện tại
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Đăng xuất
      tags:
      - Auth
  /api/auth/logout-all:
    post:
      consumes:
      - application/json
      description: Đăng xuất và revoke tất cả tokens của user (tất cả devices)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.LogoutAllResponse'
              type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Đăng xuất tất cả thiết bị
      tags:
      - Auth
  /api/auth/refresh:
    post:
      consumes:
      - application/json
      description: Làm mới access token từ refresh token
      parameters:
      - description: Refresh token
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.RefreshTokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.RefreshTokenResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Làm mới access token
      tags:
      - Auth
  /api/auth/register:
    post:
      consumes:
      - application/json
      description: Đăng ký tài khoản mới (Customer)
      parameters:
      - description: Thông tin đăng ký
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.AuthResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Đăng ký tài khoản
      tags:
      - Auth
  /api/auth/resend-verification:
    post:
      consumes:
      - application/json
      description: Gửi lại email xác thực cho user (cần đăng nhập)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.ResendVerificationResponse'
              type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "429":
          description: Too Many Requests
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.ResendCooldownResponse'
              type: object
      security:
      - BearerAuth: []
      summary: Gửi lại email xác thực
      tags:
      - Auth
  /api/auth/sessions:
    get:
      description: Lấy số lượng thiết bị đang đăng nhập
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.ActiveSessionsResponse'
              type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Lấy số session active
      tags:
      - Auth
  /api/auth/verify-email:
    post:
      consumes:
      - application/json
      description: Xác thực email của user với verification token
      parameters:
      - description: Verification token
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.VerifyEmailRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.VerifyEmailResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Xác thực email
      tags:
      - Auth
  /api/mon-an:
    get:
      consumes:
      - application/json
      description: Lấy danh sách tất cả món ăn hoặc chỉ món còn hàng
      parameters:
      - default: false
        description: Chỉ lấy món còn hàng
        in: query
        name: con_hang
        type: boolean
      produces:
      - application/json
      responses:
        "200":
          description: Lấy menu thành công
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/dto.MonAnResponse'
                  type: array
              type: object
        "500":
          description: Lỗi server
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Xem menu
      tags:
      - MonAn
    post:
      consumes:
      - application/json
      description: Thêm một món ăn mới vào menu
      parameters:
      - description: Thông tin món ăn mới
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.ThemMonRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Thêm món thành công
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.MonAnResponse'
              type: object
        "400":
          description: Dữ liệu không hợp lệ
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Thêm món ăn mới
      tags:
      - MonAn
  /api/mon-an/{id}:
    delete:
      consumes:
      - application/json
      description: Xóa một món ăn khỏi menu
      parameters:
      - description: ID món ăn
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Xóa món thành công
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "400":
          description: Không thể xóa món
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Xóa món ăn
      tags:
      - MonAn
    get:
      consumes:
      - application/json
      description: Lấy thông tin chi tiết một món ăn theo ID
      parameters:
      - description: ID món ăn
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Tìm món thành công
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.MonAnResponse'
              type: object
        "400":
          description: ID không hợp lệ
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "404":
          description: Không tìm thấy món
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Tìm món theo ID
      tags:
      - MonAn
  /api/mon-an/{id}/gia:
    put:
      consumes:
      - application/json
      description: Cập nhật giá mới cho một món ăn
      parameters:
      - description: ID món ăn
        in: path
        name: id
        required: true
        type: string
      - description: Giá mới
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.CapNhatGiaRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Cập nhật giá thành công
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.MonAnResponse'
              type: object
        "400":
          description: Dữ liệu không hợp lệ
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Cập nhật giá món ăn
      tags:
      - MonAn
  /api/mon-an/{id}/giam-gia:
    put:
      consumes:
      - application/json
      description: Áp dụng phần trăm giảm giá cho một món ăn
      parameters:
      - description: ID món ăn
        in: path
        name: id
        required: true
        type: string
      - description: Phần trăm giảm giá
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.ApDungGiamGiaRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Áp dụng giảm giá thành công
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.MonAnResponse'
              type: object
        "400":
          description: Dữ liệu không hợp lệ
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Áp dụng giảm giá
      tags:
      - MonAn
  /api/mon-an/{id}/het-hang:
    put:
      consumes:
      - application/json
      description: Đánh dấu một món ăn là hết hàng
      parameters:
      - description: ID món ăn
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Đánh dấu hết hàng thành công
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.MonAnResponse'
              type: object
        "400":
          description: Không thể đánh dấu hết hàng
          schema:
            $ref: '#/definitions/dto.APIResponse'
      summary: Đánh dấu hết hàng
      tags:
      - MonAn
  /api/users:
    get:
      consumes:
      - application/json
      description: Lấy danh sách tất cả users (Manager+)
      parameters:
      - description: Filter by role
        in: query
        name: role
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  items:
                    $ref: '#/definitions/dto.UserResponse'
                  type: array
              type: object
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Lấy danh sách users
      tags:
      - Users
    post:
      consumes:
      - application/json
      description: Tạo user mới (Manager+)
      parameters:
      - description: Thông tin user mới
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.CreateUserRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.UserResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Tạo user mới
      tags:
      - Users
  /api/users/{id}:
    delete:
      consumes:
      - application/json
      description: Vô hiệu hóa user (Admin only)
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.UserResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Vô hiệu hóa user
      tags:
      - Users
    get:
      consumes:
      - application/json
      description: Lấy thông tin user theo ID (Manager+)
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.UserResponse'
              type: object
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Lấy user theo ID
      tags:
      - Users
    put:
      consumes:
      - application/json
      description: Cập nhật thông tin user (Manager+)
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      - description: Thông tin cập nhật
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateUserRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.UserResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Cập nhật user
      tags:
      - Users
  /api/users/me:
    get:
      consumes:
      - application/json
      description: Lấy thông tin của user đang đăng nhập
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/dto.APIResponse'
            - properties:
                data:
                  $ref: '#/definitions/dto.UserResponse'
              type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Lấy thông tin user hiện tại
      tags:
      - Users
  /api/users/me/password:
    put:
      consumes:
      - application/json
      description: Đổi mật khẩu của user đang đăng nhập
      parameters:
      - description: Thông tin đổi mật khẩu
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.ChangePasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.APIResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.APIResponse'
      security:
      - BearerAuth: []
      summary: Đổi mật khẩu
      tags:
      - Users
  /health:
    get:
      consumes:
      - application/json
      description: Kiểm tra sức khỏe tổng thể của hệ thống bao gồm tất cả services
      produces:
      - application/json
      responses:
        "200":
          description: Hệ thống healthy
          schema:
            $ref: '#/definitions/handler.HealthResponse'
        "503":
          description: Hệ thống unhealthy
          schema:
            $ref: '#/definitions/handler.HealthResponse'
      summary: Full health check
      tags:
      - Health
  /health/live:
    get:
      consumes:
      - application/json
      description: Kubernetes liveness probe - kiểm tra app có đang chạy không
      produces:
      - application/json
      responses:
        "200":
          description: App đang chạy
          schema:
            $ref: '#/definitions/handler.LivenessResponse'
      summary: Liveness probe
      tags:
      - Health
  /health/ready:
    get:
      consumes:
      - application/json
      description: Kubernetes readiness probe - kiểm tra app có sẵn sàng nhận traffic
        không
      produces:
      - application/json
      responses:
        "200":
          description: App sẵn sàng
          schema:
            $ref: '#/definitions/handler.ReadinessResponse'
        "503":
          description: App chưa sẵn sàng
          schema:
            $ref: '#/definitions/handler.ReadinessResponse'
      summary: Readiness probe
      tags:
      - Health
schemes:
- http
swagger: "2.0"
