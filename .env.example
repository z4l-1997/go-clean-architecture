# ===========================================
# Restaurant Project - Environment Variables
# ===========================================
# Copy file này thành .env và điều chỉnh giá trị

# ----- SERVER -----
SERVER_PORT=8080
SERVER_HOST=0.0.0.0
SERVER_READ_TIMEOUT=15s
SERVER_WRITE_TIMEOUT=15s
SERVER_SHUTDOWN_TIMEOUT=30s

# ----- LOGGING -----
# Log level: debug, info, warn, error
LOG_LEVEL=info
# Environment: development (console format), production (JSON format)
ENVIRONMENT=development

# ----- FILE LOGGING (với Rotation) -----
# Bật/tắt ghi log ra file
LOG_FILE_ENABLED=true
# Đường dẫn file log
LOG_FILE_PATH=logs/app.log
# Kích thước tối đa mỗi file (MB) - khi vượt quá sẽ rotate
LOG_FILE_MAX_SIZE_MB=100
# Số file backup giữ lại
LOG_FILE_MAX_BACKUPS=5
# Số ngày giữ file cũ
LOG_FILE_MAX_AGE_DAYS=30
# Nén file cũ (gzip)
LOG_FILE_COMPRESS=true

# ----- MySQL -----
# Dùng cho: User, KhachHang, NhanVien
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_USER=restaurant
MYSQL_PASSWORD=restaurant123
MYSQL_DATABASE=restaurant_db
MYSQL_ROOT_PASSWORD=root123

# ----- MongoDB -----
# Dùng cho: MonAn (Menu), Order
MONGODB_URI=mongodb://restaurant:restaurant123@localhost:27017
MONGODB_DATABASE=restaurant_db
MONGO_USER=restaurant
MONGO_PASSWORD=restaurant123
MONGO_PORT=27017

# ----- Redis -----
# Dùng cho: Caching, Session
REDIS_ADDR=localhost:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_PORT=6379

# ----- Migration -----
# Tự động chạy database migrations khi khởi động app
MIGRATION_AUTO_MIGRATE=true

# ----- Development Tools (Docker) -----
# Mongo Express - MongoDB Web UI
ME_PORT=8081
ME_USER=admin
ME_PASSWORD=admin123

# phpMyAdmin - MySQL Web UI
PMA_PORT=8082

# Redis Commander - Redis Web UI
REDIS_COMMANDER_PORT=8083

# ===========================================
# MIDDLEWARE CONFIGURATION
# ===========================================

# ----- CORS -----
# Cross-Origin Resource Sharing
CORS_ENABLED=true
# Origins được phép, cách nhau bằng dấu phẩy
# ⚠️ PRODUCTION: Phải đổi sang domain thật với HTTPS!
# Ví dụ: CORS_ALLOW_ORIGINS=https://myapp.com,https://admin.myapp.com
# App sẽ CRASH nếu dùng localhost hoặc '*' trong ENVIRONMENT=production
CORS_ALLOW_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=Origin,Content-Type,Accept,Authorization,X-Request-ID
# Thời gian cache preflight (giây)
CORS_MAX_AGE=86400

# ----- Rate Limiting -----
# Bảo vệ API khỏi DDoS và abuse
RATE_LIMIT_ENABLED=true
# Requests per second
RATE_LIMIT_RPS=100
# Burst size (số request tối đa trong một lúc)
RATE_LIMIT_BURST=200

# ----- Auth Rate Limiting -----
# Rate limit nghiêm ngặt hơn cho /api/auth/* endpoints
# Chống brute force attacks
AUTH_RATE_LIMIT_ENABLED=true
# Requests per second (thấp hơn global)
AUTH_RATE_LIMIT_RPS=5
# Burst size
AUTH_RATE_LIMIT_BURST=10

# ----- JWT Authentication -----
JWT_ENABLED=true
# QUAN TRỌNG: Thay đổi secret key trong production!
JWT_SECRET_KEY=QNnLm7NfVTMWfIY2L+4HyITjf4OX6s+vkp8dnUVpDaXhOMlMZE26NIb3zA6rpHw+c+QbU1zQWTOGU+tFcCrmfQ==
# Thời gian sống access token
JWT_ACCESS_TOKEN_TTL=15m
# Thời gian sống refresh token (2 giờ - dùng rotation nên không cần dài)
JWT_REFRESH_TOKEN_TTL=2h

# ----- Request Timeout -----
TIMEOUT_ENABLED=true
# Thời gian tối đa xử lý request
TIMEOUT_DURATION=30s

# ----- Gzip Compression -----
GZIP_ENABLED=true
# Compression level: 1 (nhanh) đến 9 (nén tốt)
GZIP_LEVEL=5

# ----- Security Headers -----
SECURITY_HEADERS_ENABLED=true
# HSTS Max-Age (1 năm = 31536000 giây)
SECURITY_HSTS_MAX_AGE=31536000

# ----- Body Size Limit -----
BODY_LIMIT_ENABLED=true
# Kích thước tối đa request body (bytes)
# 1MB = 1048576, 5MB = 5242880, 10MB = 10485760
BODY_LIMIT_MAX_SIZE=1048576

# ----- Account Lockout -----
# Khóa tài khoản sau nhiều lần login sai
ACCOUNT_LOCKOUT_ENABLED=true
# Số lần thử tối đa trước khi khóa
ACCOUNT_LOCKOUT_MAX_ATTEMPTS=5
# Thời gian khóa (15 phút)
ACCOUNT_LOCKOUT_DURATION=15m

# ----- Token Blacklist -----
# Revoke tokens khi logout (sử dụng Redis)
TOKEN_BLACKLIST_ENABLED=true

# ----- Email Verification -----
# Xác thực email khi đăng ký
EMAIL_VERIFICATION_ENABLED=true
# Thời gian sống của verification token (24 giờ)
EMAIL_VERIFICATION_TOKEN_TTL=24h
# Thời gian chờ giữa các lần gửi lại email (60 giây)
EMAIL_VERIFICATION_COOLDOWN_TTL=60s

# ----- Email Settings -----
# Bật/tắt gửi email thật (false = chỉ log ra console)
EMAIL_ENABLED=false
# Base URL cho link xác thực email
EMAIL_VERIFICATION_BASE_URL=http://localhost:3000
